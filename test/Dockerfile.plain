FROM node:22

# Set working directory
WORKDIR /app

# Install wiki globally
RUN npm install -g wiki

# Install wiki-security-sessionless plugin
RUN npm install -g wiki-security-sessionless

# Create .wiki directory for data persistence
RUN mkdir -p /root/.wiki

# Expose the port (will be overridden by docker-compose)
EXPOSE 4000

# Default command - run wiki on port 4000
CMD ["wiki", "--port", "4000", "--security_type", "sessionless"]
